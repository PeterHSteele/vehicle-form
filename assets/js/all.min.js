jQuery(document).ready(function(){new class{constructor(){this.field=document.querySelector(".gfield--type-vehicle"),this.field&&(this.buttons=Array.from(this.field.querySelectorAll(".vehicle-field-button")),this.input=this.field.querySelector("input"),this.addListeners(),this.setInitialValue())}handleClick(e){var clicked=e.target.closest(".vehicle-field-button");clicked&&(e.preventDefault(),this.buttons.forEach(button=>button.classList.remove("selected")),clicked.classList.add("selected"),clicked.classList.contains("btn-motorcycle")?this.input.setAttribute("value","motorcycle"):this.input.setAttribute("value","automobile"))}setInitialValue(){const value=this.input.getAttribute("value");value&&["automobile, motorcycle"].indexOf(value)&&this.buttons.find(button=>button.classList.contains("btn-"+value)).classList.add("selected")}addListeners(){this.field.addEventListener("click",this.handleClick.bind(this))}};new class{selected=null;constructor(plans){this.form=document.querySelector(".vehicle-rental-form"),this.form&&(this.plans=plans,this.field=this.form.querySelector(".gfield--type-pricing-plan"),this.field)&&this.plans&&(this.input=this.field.querySelector("input"),this.productFields=this.form.querySelectorAll(".gfield--input-type-hiddenproduct"),this.addListeners(),this.setInitialValue())}handleClick(event){"BUTTON"==event.target.tagName&&(this.selected&&this.selected.classList.remove("selected"),event=event.target,this.selected=event.closest(".plans-field-plan"),this.selected.classList.add("selected"),event=this.plans.find(plan=>plan.duration==this.selected.dataset.duration).duration,this.updateProductFields(event),this.input.value=event,this.selected.dispatchEvent(new CustomEvent("choosePlan",{bubbles:!0,detail:{duration:event}})))}updateProductFields(chosen){this.productFields.forEach(field=>{for(let i=0;i<field.children.length;i++){var current=field.children.item(i),id=current.getAttribute("id");new RegExp("ginput_quantity_").test(id)&&(field.classList.contains(chosen)?current.setAttribute("value","1"):current.setAttribute("value","0"))}})}setInitialValue(){const value=this.input.getAttribute("value"),allowed=this.plans.map(plan=>plan.duration);if(!value||allowed.indexOf(value)<0)this.updateProductFields(null);else{const selectedPlan=this.plans.find(plan=>plan.duration==value);this.updateProductFields(value);var selected=Array.from(this.field.getElementsByClassName("plans-field-plan")).find(el=>el.dataset.duration==selectedPlan.duration);this.selected=selected,this.selected.classList.add("selected")}}handleEmptyCart(){this.selected&&(this.selected.classList.remove("selected"),this.selected=null),this.updateProductFields(null),this.input.value=""}addListeners(){this.field.addEventListener("click",this.handleClick.bind(this)),this.form.addEventListener("emptyCart",this.handleEmptyCart.bind(this))}}(Object.keys(vfplans).map(key=>vfplans[key]));function tenDays(date){return date.setDate(date.getDate()+10),date}function twoMonths(date){return date.setMonth(date.getMonth()+2),date}function oneYear(date){return date.setYear(date.getFullYear()+1),date}new class{mapPlansToTimes={};constructor(){this.form=document.querySelector(".vehicle-rental-form"),this.form&&(this.dateInput=jQuery(".start-date input[type=text]"),this.endDateInput=Array.from(this.form.querySelector(".end-date").children).find(child=>"INPUT"==child.tagName),this.addListeners(),this.setMapPlansToTimes(),this.initDatePicker(),jQuery("#ui-datepicker-div").addClass("gravity-theme"),this.planInput=this.form.querySelector(".vehicle-plan input"))}setMapPlansToTimes(){this.mapPlansToTimes["ten-day"]=tenDays,this.mapPlansToTimes["two-month"]=twoMonths,this.mapPlansToTimes.single=oneYear,this.mapPlansToTimes.annual=()=>null}handleStartDateChange(selected){var plan;!selected||!(plan=this.planInput.getAttribute("value"))||Object.keys(this.mapPlansToTimes).indexOf(plan)<0||(selected=new Date(selected),selected=[("0"+((plan=this.mapPlansToTimes[plan](new Date(selected))).getMonth()+1)).slice(-2),("0"+plan.getDate()).slice(-2),plan.getFullYear()].join("/"),this.endDateInput.setAttribute("value",selected))}handleChoosePlan(event){var duration=event?.detail?.duration;this.dateInput.attr("readonly",!1),this.initDatePicker(),this.dateInput.datepicker("setDate","annual"==duration?"12/01/2023":null),this.endDateInput.setAttribute("value",""),"annual"==event?.detail?.duration&&(this.endDateInput.setAttribute("value","01/31/2025"),this.dateInput.attr("readonly",!0),this.dateInput.datepicker("destroy"))}handleEmptyCart(event){this.handleChoosePlan(event)}initDatePicker(){var now=new Date;this.dateInput.datepicker({onSelect:this.handleStartDateChange.bind(this),yearRange:"-100:+20",showOn:"focus",dateFormat:"mm/dd/yy",changeMonth:!0,changeYear:!0,suppressDatePicker:!1,showOtherMonths:!0,selectOtherMonths:!1,minDate:now})}addListeners(){this.form.addEventListener("choosePlan",this.handleChoosePlan.bind(this)),this.form.addEventListener("emptyCart",this.handleEmptyCart.bind(this))}};new class{constructor(countries){this.countries=countries,this.field=document.querySelector(".gfield--type-license_plate"),this.field&&(this.countrySelect=this.field.querySelector(".country-select-container select"),this.plateImages=this.field.querySelectorAll(".license-backdrop"),this.plateFields=this.field.querySelectorAll(".ginput-license-inner"),this.currentLayout=Array.from(this.plateFields[0].classList).find(token=>{return new RegExp("layout-[a-z]{2}").test(token)}).slice(7),this.addListeners())}updatePlateFields(event){const country=event.target.value;country&&(this.plateFields.forEach(field=>this.updatePlateField(field,country)),this.plateImages.forEach(image=>image.setAttribute("src",this.countries[country].url)),this.currentLayout=this.countries[country].cssSuffix)}updatePlateField(field,country){field.classList.remove("layout-"+this.currentLayout),field.classList.add("layout-"+this.countries[country].cssSuffix),field.querySelectorAll("input").forEach(input=>this.updatePlateInput(input,country))}updatePlateInput(element,country){var inputId=element.getAttribute("id"),inputId=inputId[inputId.length-1],{placeholders,maxlengths}=this.countries[country];let placeholder="",maxlength="";switch(inputId){case"4":case"7":placeholder=placeholders[0],maxlength=maxlengths[0];break;case"5":case"8":placeholder=placeholders[1],maxlength=maxlengths[1];break;case"6":case"9":placeholder=placeholders[2],maxlength=maxlengths[2];break;default:placeholder=""}element.value="",element.setAttribute("placeholder",placeholder),element.setAttribute("maxlength",maxlength),element.hasAttribute("disabled")&&"0"!==maxlength?element.disabled=!1:element.hasAttribute("disabled")||"0"!=maxlength||(element.disabled=!0)}addListeners(){this.countrySelect.addEventListener("change",this.updatePlateFields.bind(this))}}(countries);class CartPlan{node={tagName:"div",children:[{tagName:"div",classes:["plans-field-plan"],children:[{tagName:"div",classes:["price-container"],children:[{tagName:"p",text:()=>this.price+"â‚¬"}]},{tagName:"div",classes:["info-container"],children:[{tagName:"h2",text:()=>this.name},{tagName:"p",text:()=>this.info}]},{tagName:"button",classes:["remove-from-cart"],children:[{tagName:"span",classes:["screen-reader-text"],text:()=>"remove from cart"},{tagName:"img",attrs:[["src",img.src],["alt",""],["role","presentation"]]}],attrs:[["type","button"]]}]}]};constructor(props){for(var prop in props)this[prop]=props[prop]}renderNode(node){const el=document.createElement(node.tagName);if(node.children){const childNodes=[];node.children.forEach(child=>childNodes.push(this.renderNode(child))),childNodes.forEach(child=>el.append(child))}var text;return node.id&&el.setAttribute("id",node.id),node.classes&&node.classes.forEach(className=>el.classList.add(className)),node.text&&(text=document.createTextNode(node.text()),el.append(text)),node.attrs&&node.attrs.forEach(attr=>{el.setAttribute(attr[0],attr[1])}),el}render(){return this.renderNode(this.node)}}new class{constructor(plans){this.plans=plans,this.form=document.querySelector(".vehicle-rental-form"),this.form&&(this.field=this.form.querySelector(".gfield--type-cart_and_terms"),this.field)&&(this.cart=this.field.querySelector(".vf-cart"),this.chosenPlan=this.cart.querySelector(".chosen-plan"),this.addListeners())}addListeners(){this.form.addEventListener("choosePlan",this.handlePlanChoice.bind(this)),this.cart.addEventListener("click",this.handleClick.bind(this))}handlePlanChoice(event){var plan=this.plans.find(plan=>event.detail.duration==plan.duration);plan&&(plan.price=Number(plan.price).toFixed(2),this.chosenPlan.children.item(0)?.remove(),this.chosenPlan.append(new CartPlan(plan).render()))}handleClick(event){event.target.closest(".remove-from-cart")&&(this.chosenPlan.dispatchEvent(new CustomEvent("emptyCart",{bubbles:!0})),this.chosenPlan.children.item(0).remove())}}(Object.keys(vfplans).map(key=>vfplans[key]))});
